<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:fragment="headerfiles">

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/album/">

    <!-- Bootstrap core CSS -->
    <link th:href="@{css/bootstrap.css}" rel="stylesheet">
    <link th:href="@{css/stylesheet.css}" rel="stylesheet">

    <!-- For dropdown to work -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <!-- Add icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
<div th:fragment="evidenceForm">

    <!-- https://www.codeproject.com/Tips/5162015/Multi-select-Check-Box-List-or-Checkbox-Dropdown-w-->
    <!-- Code until the next link is directly sourced from the above link under the Code Project Open License -->
    <style>
        .MultiCheckBox {
            font-family: nexa !important;
            color: #000000 !important;
            font-size: 100% !important;
            background-color: #F7FEFF !important;
            border-style: solid !important;
            border-color: #19DAFF !important;
            border-width: 10px !important;
            border-radius: 10px 20px 20px 20px !important;
        }

        .MultiCheckBox .k-icon{
            font-size: 15px;
            float: right;
            font-weight: bolder;
            margin-top: -7px;
            height: 10px;
            width: 14px;
            color:#787878;
        }

        .MultiCheckBoxDetail {
            display:none;
            position:absolute;
            border:1px solid #e2e2e2;
            overflow-y:hidden;
            color: #000000 !important;
            font-size: 110% !important;
            background-color: #F7FEFF !important;
        }

        .MultiCheckBoxDetailBody {
            overflow-y:scroll;
        }

        .MultiCheckBoxDetail .cont  {
            clear:both;
            overflow: hidden;
            padding: 2px;
        }

        .MultiCheckBoxDetail .cont:hover  {
            background-color:#cfcfcf;
        }

        .MultiCheckBoxDetailBody > div > div {
            float:left;
        }

        .MultiCheckBoxDetail>div>div:nth-child(1) {

        }

        .MultiCheckBoxDetailHeader {
            overflow:hidden;
            position:relative;
            height: 28px;
            color: #000000 !important;
            background-color: #F7FEFF !important;
        }

        .MultiCheckBoxDetailHeader>input {
            position: absolute;
            top: 4px;
            color: #000000 !important;
            left: 3px;
        }

        .MultiCheckBoxDetailHeader>div {
            position: absolute;
            top: 5px;
            left: 24px;
            color:#000000;
        }
    </style>
    <script>
        $(document).ready(function () {
            $("#evidence_category").CreateMultiCheckBox({ width: '230px', defaultText : 'Select Below', height:'250px' });
        });

        $(document).ready(function () {
            $(document).on("click", ".MultiCheckBox", function () {
                var detail = $(this).next();
                detail.show();
            });

            $(document).on("click", ".MultiCheckBoxDetailHeader input", function (e) {
                e.stopPropagation();
                var hc = $(this).prop("checked");
                $(this).closest(".MultiCheckBoxDetail").find(".MultiCheckBoxDetailBody input").prop("checked", hc);
                $(this).closest(".MultiCheckBoxDetail").next().UpdateSelect();
            });

            $(document).on("click", ".MultiCheckBoxDetailHeader", function (e) {
                var inp = $(this).find("input");
                var chk = inp.prop("checked");
                inp.prop("checked", !chk);
                $(this).closest(".MultiCheckBoxDetail").find(".MultiCheckBoxDetailBody input").prop("checked", !chk);
                $(this).closest(".MultiCheckBoxDetail").next().UpdateSelect();
            });

            $(document).on("click", ".MultiCheckBoxDetail .cont input", function (e) {
                e.stopPropagation();
                $(this).closest(".MultiCheckBoxDetail").next().UpdateSelect();

                var val = ($(".MultiCheckBoxDetailBody input:checked").length == $(".MultiCheckBoxDetailBody input").length)
                $(".MultiCheckBoxDetailHeader input").prop("checked", val);
            });

            $(document).on("click", ".MultiCheckBoxDetail .cont", function (e) {
                var inp = $(this).find("input");
                var chk = inp.prop("checked");
                inp.prop("checked", !chk);

                var multiCheckBoxDetail = $(this).closest(".MultiCheckBoxDetail");
                var multiCheckBoxDetailBody = $(this).closest(".MultiCheckBoxDetailBody");
                multiCheckBoxDetail.next().UpdateSelect();

                var val = ($(".MultiCheckBoxDetailBody input:checked").length == $(".MultiCheckBoxDetailBody input").length)
                $(".MultiCheckBoxDetailHeader input").prop("checked", val);
            });

            $(document).mouseup(function (e) {
                var container = $(".MultiCheckBoxDetail");
                if (!container.is(e.target) && container.has(e.target).length === 0) {
                    container.hide();
                }
            });
        });

        var defaultMultiCheckBoxOption = { width: '220px', defaultText: 'Select Below', height: '200px' };

        jQuery.fn.extend({
            CreateMultiCheckBox: function (options) {

                var localOption = {};
                localOption.width = (options != null && options.width != null && options.width != undefined) ? options.width : defaultMultiCheckBoxOption.width;
                localOption.defaultText = (options != null && options.defaultText != null && options.defaultText != undefined) ? options.defaultText : defaultMultiCheckBoxOption.defaultText;
                localOption.height = (options != null && options.height != null && options.height != undefined) ? options.height : defaultMultiCheckBoxOption.height;

                this.hide();
                this.attr("multiple", "multiple");
                var divSel = $("<div class='MultiCheckBox'>" + localOption.defaultText + "<span class='k-icon k-i-arrow-60-down'><svg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='sort-down' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512' class='svg-inline--fa fa-sort-down fa-w-10 fa-2x'><path fill='currentColor' d='M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41z' class=''></path></svg></span></div>").insertBefore(this);
                divSel.css({ "width": localOption.width });

                var detail = $("<div class='MultiCheckBoxDetail'><div class='MultiCheckBoxDetailHeader'><input type='checkbox' class='mulinput' value='-1982' /><div>Select All</div></div><div class='MultiCheckBoxDetailBody'></div></div>").insertAfter(divSel);
                detail.css({ "width": parseInt(options.width) + 10, "max-height": localOption.height });
                var multiCheckBoxDetailBody = detail.find(".MultiCheckBoxDetailBody");

                this.find("option").each(function () {
                    var val = $(this).attr("value");

                    if (val == undefined)
                        val = '';

                    multiCheckBoxDetailBody.append("<div class='cont'><div><input type='checkbox' class='mulinput' value='" + val + "' /></div><div>" + $(this).text() + "</div></div>");
                });

                multiCheckBoxDetailBody.css("max-height", (parseInt($(".MultiCheckBoxDetail").css("max-height")) - 28) + "px");
            },
            UpdateSelect: function () {
                var arr = [];

                this.prev().find(".mulinput:checked").each(function () {
                    arr.push($(this).val());
                });

                this.val(arr);
            },
        });
    </script>
    <!-- https://www.codeproject.com/Tips/5162015/Multi-select-Check-Box-List-or-Checkbox-Dropdown-w-->
    <!-- Code no longer sourced from the above link -->

        <div class="portion_body" >
        <form>
                <div class="row-1" style="display:flex;">
                        <div class="evidence_form_element col-4">
                            <b class="evidence_head setWide">Title*:</b><br> <input type="text" id="evidence_title" maxlength="100" class="project_edit_data" oninput="updateTitle()">
                            <label class="project_inputAlertBlue" id="titleCharCount">Characters Remaining: 100</label>
                        </div>
                        <div class="evidence_form_element col-3">
                            <b class="evidence_head setWide">Date*:</b> <br><input type="date" class="project_edit_data">
                        </div>
                        <div class="evidence_form_element align-content-center col-5">
                            <!-- https://bbbootstrap.com/snippets/multiselect-dropdown-list-83601849# -->
                            <b class="evidence_head setWide">Category:</b><br>
                            <select id="evidence_category" class="project_edit_data">
                                <option value="Quantitative skills">&nbsp;&nbsp;Quantitative skills</option>
                                <option value="Qualitative skills">&nbsp;&nbsp;Qualitative skills</option>
                                <option value="Service">&nbsp;&nbsp;Service</option>
                            </select>
                        </div>
                </div>
                    <br>
                    <br>
                    <br>

                <div class="row-1">
                    <div>
                        <b class="evidence_head setWide">Description*:</b><br> <textarea type="text" maxlength="2000" id="evidence_desc" oninput="updateDesc()" class=" description-input project_edit_data horizontal_field bio setWide"></textarea>
                        <label class="project_inputAlertBlue" id="descCharCount">Characters Remaining: 2000</label>
                    </div>
                    <!-- When enter is pressed, default form action is to submit the first button. As our form contains buttons, this empty button exists to consume the default action. -->
                    <button onclick="return false;" style="display: none"></button>
                    <b class="evidence_head setWide" id="skills_input">Skills:</b><br>
                    <div class="col-12" id="skills_div" style="display: flex; justify-content: center; align-items: center;">
                            <!-- Style for padding and margin here place the button inside the input, and ensure text won't collide with button -->
                        <input type="text" id="add_skill_input" maxlength=100 oninput="updateSkills()"  class="evidence_form_element_wide project_edit_data">
                            <button id="add_skill_button" type="button" style="margin-left: 1em" class="table_text user_role_table" th:text="Add" onclick="addSkill(); return false;"></button>
                        </input>
                    </div>
                    <label class="project_inputAlertBlue" id="skillCharCount" style="padding-left: 5px">Characters Remaining: 100</label>
                    <br>
                    <div id="skills_container" style="width: 100%">
                        <div id="skill_sub_1" style="display: flex; width: 100%"></div>
                    </div>
                    <script>
                        // Event listener to add skills when enter is pressed and the skill input is selected
                        document.querySelector("#add_skill_input").addEventListener("keyup", event => {
                            if (event.key !== "Enter") return;
                            addSkill()
                        })

                        let skills = new Set()
                        let skillRow = document.getElementById("skill_sub_1");

                        // Adds the skill to the set and resets the input.
                        function addSkill() {
                            let newSkill = document.getElementById("add_skill_input").value
                            if (skills.has(newSkill)) return;
                            skills.add(newSkill)
                            document.getElementById("add_skill_input").value = ""
                            appendSkill(newSkill)
                        }

                        // Inserts a new skill tag into the form
                        function appendSkill(skillText) {
                            let skillTag = document.createElement("button");
                            skillTag.id = "skill_" + skillText
                            skillTag.className = "table_text skill_tag"
                            skillTag.innerText = skillText + " ✖"
                            skillTag.value = skillText
                            skillTag.onclick = removeSkill;
                            skillRow.appendChild(skillTag);
                            if (skillRow.getBoundingClientRect().right < skillTag.getBoundingClientRect().right) {
                                skillRow.removeChild(skillTag)
                                insertSkillRow()
                                skillRow.appendChild(skillTag);
                            }
                        }

                        // Creates a new row for skill tags to be placed on, for some reason inserting <br> couldn't do this
                        function insertSkillRow() {
                            let newSkillRow = document.createElement("div");
                            newSkillRow.style.display = "flex"
                            document.getElementById("skills_container").appendChild(newSkillRow)
                            skillRow = newSkillRow
                        }

                        // Deletes a skill then rebuilds the skill list
                        function removeSkill(event) {
                            skills.delete(event.target.value)
                            clearSkills()
                            insertSkillRow()
                            for (const skill of skills) {
                                appendSkill(skill)
                            }
                            return false;
                        }

                        // Removes all skills from display
                        function clearSkills() {
                            let skillContainer = document.getElementById("skills_container")
                            while (skillContainer.lastChild) {
                                skillContainer.removeChild(skillContainer.lastChild)
                            }
                        }
                    </script>
                    <div class="col-12">
                        <b class="evidence_head setWide" id="links_input">Links:</b><br>
                        <div class="col-12" id="links_div" style="display: flex; justify-content: center; align-items: center;">
                            <!-- Style for padding and margin here place the button inside the input, and ensure text won't collide with button -->
                            <input type="text" id="add_link_input" class="evidence_form_element_wide project_edit_data">
                            <button id="add_link_button" type="button" style="margin-left: 1em" class="table_text user_role_table" th:text="Add" onclick="addLink(); return false;"></button>
                            </input>
                        </div>
                        <br>
                        <div id="links_and_submit" style="display: flex">
                            <div id="links_container" style="width: 85%; display: block">

                            </div>
                            <div id="submit_and_cancel" style="width: 15%; display: block; justify-content: left">
                                <button class="cancel_evidence" type="button">
                                    <a class="button_a" th:href="@{evidence}">CANCEL</a>
                                </button>
                                <button class="save_evidence" id="projectSave" type="submit">SAVE</button>
                            </div>
                        </div>
                    </div>
                    <script>
                        // Event listener to add links when enter is pressed and the link input is selected
                        document.querySelector("#add_link_input").addEventListener("keyup", event => {
                            if (event.key !== "Enter") return;
                            addLink()
                        })

                        let links = new Set()
                        let linksContainer = document.getElementById("links_container")
                        let linkCounter = 0;

                        // Adds the link to the set and resets the input.
                        function addLink() {
                            let newLink = document.getElementById("add_link_input").value
                            if (links.has(newLink)) return;
                            links.add(newLink)
                            document.getElementById("add_link_input").value = ""
                            appendLink(newLink)
                        }

                        // Inserts a new link into the form
                        function appendLink(linkText) {
                            let linkBox = document.createElement("div");
                            linksContainer.appendChild(linkBox)
                            linkBox.className = "trim_text"
                            linkBox.style.display = "flex"
                            let newLink = document.createElement("a");
                            newLink.id = "link_" + linkText
                            newLink.className = "sprint-description display_data text_button trim_text"
                            newLink.style.fontSize = "110%"
                            newLink.width = "90% !important"
                            newLink.style.display = "inline-block"
                            linkCounter++
                            newLink.innerText = linkCounter + ".  " + linkText
                            newLink.href = linkText
                            let linkDelete = document.createElement("button");
                            linkDelete.className = "fa fa-trash each_link"
                            linkDelete.value = linkText
                            linkDelete.onclick = removeLink;
                            linkBox.appendChild(newLink)
                            linkBox.appendChild(linkDelete)
                        }

                        // Deletes a link then rebuilds the link list
                        function removeLink(event) {
                            links.delete(event.target.value)
                            clearLinks()
                            linkCounter = 0
                            for (const link of links) {
                                appendLink(link)
                            }
                            return false;
                        }

                        // Removes all links from display
                        function clearLinks() {
                            let linkContainer = document.getElementById("links_container")
                            while (linkContainer.lastChild) {
                                linkContainer.removeChild(linkContainer.lastChild)
                            }
                        }
                    </script>
                    <script>
                        function updateTitle() {
                            const titleCounter = document.getElementById("titleCharCount")
                            const titleInput = document.getElementById("evidence_title")
                            titleCounter.innerText = "Characters Remaining: "  + (100 - titleInput.value.length)
                        }

                        function updateDesc() {
                            const descCounter = document.getElementById("descCharCount")
                            const descInput = document.getElementById("evidence_desc")
                            descCounter.innerText = "Characters Remaining: "  + (2000 - descInput.value.length)
                        }

                        function updateSkills() {
                            const skillCounter = document.getElementById("skillCharCount")
                            const skillInput = document.getElementById("add_skill_input")
                            skillCounter.innerText = "Characters Remaining: "  + (100 - skillInput.value.length)
                        }
                    </script>
                </div>
        </form>
        </div>
</div>
</body>
</html>
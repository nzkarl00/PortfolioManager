<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:fragment="head(title)">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <!-- Bootstrap core CSS -->
  <link th:href="@{css/bootstrap.css}" rel="stylesheet">
  <link th:href="@{css/stylesheet.css}" rel="stylesheet">

  <title th:text="${title}"></title>
  <!-- For dropdown to work -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <!-- Add icon library -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- https://www.codeproject.com/Tips/5162015/Multi-select-Check-Box-List-or-Checkbox-Dropdown-w-->
  <!-- Code until the next link is directly sourced from the above link under the Code Project Open License -->
  <style>
    .MultiCheckBox {
      font-family: nexa !important;
      color: #000000 !important;
      font-size: 100% !important;
      background-color: #F7FEFF !important;
      border-style: solid !important;
      border-color: #19DAFF !important;
      border-width: 10px !important;
      border-radius: 10px 20px 20px 20px !important;
    }

    .MultiCheckBox .k-icon{
      font-size: 15px;
      float: right;
      font-weight: bolder;
      margin-top: -7px;
      height: 10px;
      width: 14px;
      color:#787878;
    }

    .MultiCheckBoxDetail {
      display:none;
      position:absolute;
      border:1px solid #e2e2e2;
      overflow-y:hidden;
      color: #000000 !important;
      font-size: 110% !important;
      background-color: #F7FEFF !important;
    }

    .MultiCheckBoxDetailBody {
      overflow-y:scroll;
    }

    .MultiCheckBoxDetail .cont  {
      clear:both;
      overflow: hidden;
      padding: 2px;
    }

    .MultiCheckBoxDetail .cont:hover  {
      background-color:#cfcfcf;
    }

    .MultiCheckBoxDetailBody > div > div {
      float:left;
    }

    .MultiCheckBoxDetail>div>div:nth-child(1) {

    }

    .MultiCheckBoxDetailHeader {
      overflow:hidden;
      position:relative;
      height: 28px;
      color: #000000 !important;
      background-color: #F7FEFF !important;
    }

    .MultiCheckBoxDetailHeader>input {
      position: absolute;
      top: 4px;
      color: #000000 !important;
      left: 3px;
    }

    .MultiCheckBoxDetailHeader>div {
      position: absolute;
      top: 5px;
      left: 24px;
      color:#000000;
    }
  </style>
  <script>
    $(document).ready(function () {
      $("#evidence_category").CreateMultiCheckBox({ width: '230px', defaultText : 'Select Below', height:'250px' });
    });

    $(document).ready(function () {
      $(document).on("click", ".MultiCheckBox", function () {
        var detail = $(this).next();
        detail.show();
      });

      $(document).on("click", ".MultiCheckBoxDetailHeader input", function (e) {
        e.stopPropagation();
        var hc = $(this).prop("checked");
        $(this).closest(".MultiCheckBoxDetail").find(".MultiCheckBoxDetailBody input").prop("checked", hc);
        $(this).closest(".MultiCheckBoxDetail").next().UpdateSelect();
      });

      $(document).on("click", ".MultiCheckBoxDetailHeader", function (e) {
        var inp = $(this).find("input");
        var chk = inp.prop("checked");
        inp.prop("checked", !chk);
        $(this).closest(".MultiCheckBoxDetail").find(".MultiCheckBoxDetailBody input").prop("checked", !chk);
        $(this).closest(".MultiCheckBoxDetail").next().UpdateSelect();
      });

      $(document).on("click", ".MultiCheckBoxDetail .cont input", function (e) {
        e.stopPropagation();
        $(this).closest(".MultiCheckBoxDetail").next().UpdateSelect();

        var val = ($(".MultiCheckBoxDetailBody input:checked").length == $(".MultiCheckBoxDetailBody input").length)
        $(".MultiCheckBoxDetailHeader input").prop("checked", val);
      });

      $(document).on("click", ".MultiCheckBoxDetail .cont", function (e) {
        var inp = $(this).find("input");
        var chk = inp.prop("checked");
        inp.prop("checked", !chk);

        var multiCheckBoxDetail = $(this).closest(".MultiCheckBoxDetail");
        var multiCheckBoxDetailBody = $(this).closest(".MultiCheckBoxDetailBody");
        multiCheckBoxDetail.next().UpdateSelect();

        var val = ($(".MultiCheckBoxDetailBody input:checked").length == $(".MultiCheckBoxDetailBody input").length)
        $(".MultiCheckBoxDetailHeader input").prop("checked", val);
      });

      $(document).mouseup(function (e) {
        var container = $(".MultiCheckBoxDetail");
        if (!container.is(e.target) && container.has(e.target).length === 0) {
          container.hide();
        }
      });
    });

    var defaultMultiCheckBoxOption = { width: '220px', defaultText: 'Select Below', height: '200px' };

    jQuery.fn.extend({
      CreateMultiCheckBox: function (options) {

        var localOption = {};
        localOption.width = (options != null && options.width != null && options.width != undefined) ? options.width : defaultMultiCheckBoxOption.width;
        localOption.defaultText = (options != null && options.defaultText != null && options.defaultText != undefined) ? options.defaultText : defaultMultiCheckBoxOption.defaultText;
        localOption.height = (options != null && options.height != null && options.height != undefined) ? options.height : defaultMultiCheckBoxOption.height;

        this.hide();
        this.attr("multiple", "multiple");
        var divSel = $("<div class='MultiCheckBox'>" + localOption.defaultText + "<span class='k-icon k-i-arrow-60-down'><svg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='sort-down' role='img' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 320 512' class='svg-inline--fa fa-sort-down fa-w-10 fa-2x'><path fill='currentColor' d='M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41z' class=''></path></svg></span></div>").insertBefore(this);
        divSel.css({ "width": localOption.width });

        var detail = $("<div class='MultiCheckBoxDetail'><div class='MultiCheckBoxDetailHeader'><input type='checkbox' class='mulinput' value='-1982' /><div>Select All</div></div><div class='MultiCheckBoxDetailBody'></div></div>").insertAfter(divSel);
        detail.css({ "width": parseInt(options.width) + 10, "max-height": localOption.height });
        var multiCheckBoxDetailBody = detail.find(".MultiCheckBoxDetailBody");

        this.find("option").each(function () {
          var val = $(this).attr("value");

          if (val == undefined)
            val = '';

          multiCheckBoxDetailBody.append("<div class='cont'><div><input type='checkbox' class='mulinput' value='" + val + "' /></div><div>" + $(this).text() + "</div></div>");
        });

        multiCheckBoxDetailBody.css("max-height", (parseInt($(".MultiCheckBoxDetail").css("max-height")) - 28) + "px");
      },
      UpdateSelect: function () {
        var arr = [];

        this.prev().find(".mulinput:checked").each(function () {
          arr.push($(this).val());
        });

        this.val(arr);
      },
    });
  </script>
  <!-- https://www.codeproject.com/Tips/5162015/Multi-select-Check-Box-List-or-Checkbox-Dropdown-w-->
  <!-- Code no longer sourced from the above link -->
</head>

<body>
<div th:fragment="navbar">

  <!-- Navigation Bar -->
  <nav class="navbar sticky-top navbar-light bg-light">
    <div class="container-fluid ms-auto fluid">

      <!-- Membership date information -->
      <p class="nav-item header_date fluid">
        Member Since: <br>
        <span th:text="${date}" ></span>
      </p>

      <!-- Username information -->
      <p class="nav-item header_name">
        <span th:text="${username}" ></span>
      </p>

      <!-- Profile picture, that functions as a dropdown menu -->
      <div class="dropdown">
        <!-- Creating the default of what you see when profile picture drop down is closed -->
        <button class="btn btn-primary dropdown-toggle dropdown-circle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          <img class="img-fluid rounded-circle border border-primary rounded-circle" th:src="@{profile_none.png}" width=90em height=90em alt="">
        </button>
        <!-- Creating dropdown items when the profile picture dropdown is open/active -->
        <ul class="dropdown-menu align-middle">
          <!-- These buttons take you to other end points -->
          <li><a class="dropdown-item" th:href="@{'landing'}">Project</a></li>
          <li><a class="dropdown-item" th:href="@{'account'}">Account</a></li>
          <li><a class="dropdown-item" th:href="@{'user-list'}">Users</a></li>
          <!-- This logout button triggers the Logout Confirmation Modal to pop up -->
          <li><a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutConfirmationModal">Logout</a></li>
        </ul>
      </div>

    </div>
  </nav>


  <!-- Logout Confirmation Modal -->
  <div class="modal fade" id="logoutConfirmationModal" tabindex="-1" role="dialog" aria-labelledby="logoutConfirmationModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <span class="modal-title align-middle">Logout</span>
        </div>
        <div class="modal-body d-flex justify-content-center">
          Are you sure you want to logout?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary align-baseline" data-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary align-text-bottom">
            <!-- Confirm Logout button will take you to /logout end point, and back to /login -->
            <a class="button_a" th:href="@{'logout'}">Confirm Logout</a>
          </button>
        </div>
      </div>
    </div>
  </div>

</div>

</body>
</html>
